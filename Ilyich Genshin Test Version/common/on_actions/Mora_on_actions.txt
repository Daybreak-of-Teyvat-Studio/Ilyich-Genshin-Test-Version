################ this is the core of the mod when all calculation and stock information is keep###############
on_actions = {
    #################### this is to set up the initial conditions for stockpile, add the first equipment stockpile, determinate if a country is major will get some money otherwise the will get another amount of money##################
	on_startup = {
		effect = {
		    every_country = {
                set_variable = { inflation_level = inflation_money }
		        set_variable = { inflation_money = 0 }
		    }
		    
		    
		    HAI={
		        set_variable = { global.infantrystock = 40000 }
		        set_variable = { global.supportstock = 3000 }
		        set_variable = { global.artillerystock = 3000 }
		        set_variable = { global.motorizedstock = 2000 }
		        set_variable = { global.antitankstock = 2000 }
		        set_variable = { global.antiairstock = 2000 }
		        set_variable = { global.lighttankstock = 2000 }
		        set_variable = { global.mediumtankstock = 1000 }
		        set_variable = { global.heavytankstock = 1000 }
		        set_variable = { global.convoystock = 100 }
		    }
		    every_country={
		        limit={
		            is_ai=no
		        }
		        country_event = { days = 360 id = moneymod.1 }
		    }
		    every_country={		
				if={
				    
				    limit={
						is_major = no
					}
				    
				    set_variable = { a = 51}
				    set_variable = { dx = a }
					
					else={
						set_variable = { a = 76}
						set_variable = { dx = a }
					}
				}
			}
			every_country={
			    set_variable = { debttotal = 0}
			}
		}
	}
    
    ################################# here are all variable and calculation needed to see how much money your country is making################	
    on_daily = {
		effect = {

		    every_country = {
		        limit = {
		            check_variable = { inflation_level = 0 }
		        }

                add_ideas = inflation_level_0
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 1 }
                }

                add_ideas = inflation_level_1
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 2 }
                }

                add_ideas = inflation_level_2
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 3 }
                }

                add_ideas = inflation_level_3
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 4 }
                }

                add_ideas = inflation_level_4
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 5 }
                }

                add_ideas = inflation_level_5
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 6 }
                }

                add_ideas = inflation_level_6
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 7 }
                }

                add_ideas = inflation_level_7
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 8 }
                }

                add_ideas = inflation_level_8
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 9 }
                }

                add_ideas = inflation_level_9
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 10 }
                }

                add_ideas = inflation_level_10
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 11 }
                }

                add_ideas = inflation_level_11
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 12 }
                }

                add_ideas = inflation_level_12
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 13 }
                }

                add_ideas = inflation_level_13
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 14 }
                }

                add_ideas = inflation_level_14
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 15 }
                }

                add_ideas = inflation_level_15
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 16 }
                }

                add_ideas = inflation_level_16
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 17 }
                }

                add_ideas = inflation_level_17
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 18 }
                }

                add_ideas = inflation_level_18
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 19 }
                }

                add_ideas = inflation_level_19
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 20 }
                }

                add_ideas = inflation_level_20
            }

            ################################################
            ################################################
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 21 }
                }

                add_ideas = inflation_level_21
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 22 }
                }

                add_ideas = inflation_level_22
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 23 }
                }

                add_ideas = inflation_level_23
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 24 }
                }

                add_ideas = inflation_level_24
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 25 }
                }

                add_ideas = inflation_level_25
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 26 }
                }

                add_ideas = inflation_level_26
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 27 }
                }

                add_ideas = inflation_level_27
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 28 }
                }

                add_ideas = inflation_level_28
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 29 }
                }

                add_ideas = inflation_level_29
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 30 }
                }

                add_ideas = inflation_level_30
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 31 }
                }

                add_ideas = inflation_level_31
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 32 }
                }

                add_ideas = inflation_level_32
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 33 }
                }

                add_ideas = inflation_level_33
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 34 }
                }

                add_ideas = inflation_level_34
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 35 }
                }

                add_ideas = inflation_level_35
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 36 }
                }

                add_ideas = inflation_level_36
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 37 }
                }

                add_ideas = inflation_level_37
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 38 }
                }

                add_ideas = inflation_level_38
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 39 }
                }

                add_ideas = inflation_level_39
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 40 }
                }

                add_ideas = inflation_level_40
            }

            ################################################
            ################################################

            every_country = {
                limit = {
                    check_variable = { inflation_level = 41 }
                }

                add_ideas = inflation_level_41
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 42 }
                }

                add_ideas = inflation_level_42
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 43 }
                }

                add_ideas = inflation_level_43
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 44 }
                }

                add_ideas = inflation_level_44
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 45 }
                }

                add_ideas = inflation_level_45
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 46 }
                }

                add_ideas = inflation_level_46
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 47 }
                }

                add_ideas = inflation_level_47
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 48 }
                }

                add_ideas = inflation_level_48
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 49 }
                }

                add_ideas = inflation_level_49
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 50 }
                }

                add_ideas = inflation_level_50
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 51 }
                }

                add_ideas = inflation_level_51
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 52 }
                }

                add_ideas = inflation_level_52
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 53 }
                }

                add_ideas = inflation_level_53
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 54 }
                }

                add_ideas = inflation_level_54
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 55 }
                }

                add_ideas = inflation_level_55
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 56 }
                }

                add_ideas = inflation_level_56
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 57 }
                }

                add_ideas = inflation_level_57
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 58 }
                }

                add_ideas = inflation_level_58
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 59 }
                }

                add_ideas = inflation_level_59
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 60 }
                }

                add_ideas = inflation_level_60
            }

            ################################################
            ################################################

            every_country = {
                limit = {
                    check_variable = { inflation_level = 61 }
                }

                add_ideas = inflation_level_61
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 62 }
                }

                add_ideas = inflation_level_62
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 63 }
                }

                add_ideas = inflation_level_63
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 64 }
                }

                add_ideas = inflation_level_64
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 65 }
                }

                add_ideas = inflation_level_65
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 66 }
                }

                add_ideas = inflation_level_66
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 67 }
                }

                add_ideas = inflation_level_67
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 68 }
                }

                add_ideas = inflation_level_68
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 69 }
                }

                add_ideas = inflation_level_69
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 70 }
                }

                add_ideas = inflation_level_70
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 71 }
                }

                add_ideas = inflation_level_71
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 72 }
                }

                add_ideas = inflation_level_72
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 73 }
                }

                add_ideas = inflation_level_73
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 74 }
                }

                add_ideas = inflation_level_74
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 75 }
                }

                add_ideas = inflation_level_75
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 76 }
                }

                add_ideas = inflation_level_76
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 77 }
                }

                add_ideas = inflation_level_77
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 78 }
                }

                add_ideas = inflation_level_78
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 79 }
                }

                add_ideas = inflation_level_79
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 80 }
                }

                add_ideas = inflation_level_80
            }

            ################################################
            ################################################

            every_country = {
                limit = {
                    check_variable = { inflation_level = 81 }
                }

                add_ideas = inflation_level_81
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 82 }
                }

                add_ideas = inflation_level_82
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 83 }
                }

                add_ideas = inflation_level_83
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 84 }
                }

                add_ideas = inflation_level_84
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 85 }
                }

                add_ideas = inflation_level_85
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 86 }
                }

                add_ideas = inflation_level_86
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 87 }
                }

                add_ideas = inflation_level_87
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 88 }
                }

                add_ideas = inflation_level_88
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 89 }
                }

                add_ideas = inflation_level_89
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 90 }
                }

                add_ideas = inflation_level_90
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 91 }
                }

                add_ideas = inflation_level_91
            }

            every_country = {
                limit = {
                    check_variable = { inflation_level = 92 }
                }

                add_ideas = inflation_level_92
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 93 }
                }

                add_ideas = inflation_level_93
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 94 }
                }

                add_ideas = inflation_level_94
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 95 }
                }

                add_ideas = inflation_level_95
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 96 }
                }

                add_ideas = inflation_level_96
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 97 }
                }

                add_ideas = inflation_level_97
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 98 }
                }

                add_ideas = inflation_level_98
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 99 }
                }

                add_ideas = inflation_level_99
            }
            
            every_country = {
                limit = {
                    check_variable = { inflation_level = 100 }
                }

                add_ideas = inflation_level_100
            }

            ################################################
		    
		    clear_variable = resourceincome
			clear_variable = resourceexpenses
			clear_variable = allexpenses
			clear_variable = nmn
			
			set_variable = { nmn = 0}
			divide_variable = { var = nmn value = 10 }

			every_country={
			    limit={
			        is_puppet = yes
			    }
			    divide_variable ={var=overcome value=2}
			    set_variable = { tax_to_overlord =overcome}
			}
				
            ################not used#################these are special calculation for some countries with a high population but is no longer used#########
			
			every_country={
			    limit={
			        tag=RAJ
			    }
			    set_variable = { nerfeco =0}
			}
			every_country={
			    limit={
				    tag=BRA
			    }
			    set_variable = { nerfeco =0}
			}
			every_country={
			    limit={
				    has_idea=great_depression
			    }
			    set_variable = { depression = 0 }
			}
				

			every_country={
			    limit={
			        OR={
				        has_idea=CAN_great_depression_1
				        has_idea=CAN_great_depression_2
				        has_idea=AST_great_depression_1
				        has_idea=AST_great_depression_2
				        has_idea=AST_great_depression_3
			        }
			    }
			    set_variable = { depression = 0.0}
			}	
			every_country={
			    limit={
				    tag=JAP
			    }
			    set_variable = { nerfeco = 0}
			}
			every_country={
			    limit={
				    tag=GER
			    }
			    set_variable = { nerfeco = 0}
			}
            ##################################used, this is the money calculation. the base for the whole mod######################
               
              #set_variable = { cfff = num_of_available_civilian_factories}
			#divide_variable = { var = cfff value = 1.0 }
			
			set_variable = { tax= num_of_civilian_factories}
			divide_variable = { var = tax value = 20 }  #1.0
			
			set_variable = { chromium_import = resource_imported@chromium}
			divide_variable = { var = chromium_import value = 100 }
			
			set_variable = { tungsten_import = resource_imported@tungsten}
			divide_variable = { var = tungsten_import value = 150 }
			
			set_variable = { rubber_import = resource_imported@rubber}
			divide_variable = { var = rubber_import value = 150 }
			
			set_variable = { aluminium_import = resource_imported@aluminium}
			divide_variable = { var = aluminium_import value = 150 }
			
			set_variable = { oil_import = resource_imported@oil}
			divide_variable = { var = oil_import value = 100 }
			
			set_variable = { steel_import = resource_imported@steel}
			divide_variable = { var = steel_import value = 150 }

			

			#set_variable = { debtexp = debttotal}
			#divide_variable = { var = debtexp value = 40 }
			
			#一个民工1，一个军工0.4，一个海工0.2，一个营0.1
			
			set_variable = { nf = num_of_military_factories} #军工0.4
			divide_variable = { var = nf value = 2.5 } 			
			set_variable = { navf = num_of_naval_factories}  #民工0.2
			divide_variable = { var = navf value = 5.0 } 			
			set_variable = { ms = num_battalions}            #陆军营0.05
			divide_variable = { var = ms value = 50 } 
			
			set_variable = { cfff = 5.0 }                   #国家基础收入
			
			set_variable = { chromium_export = resource_exported@chromium}
			divide_variable = { var = chromium_export value = 200 }
			
			set_variable = { tungsten_export = resource_exported@tungsten}
			divide_variable = { var = tungsten_export value = 400 }
			
			set_variable = { rubber_export = resource_exported@rubber}
			divide_variable = { var = rubber_export value = 400 }
			
			set_variable = { aluminium_export = resource_exported@aluminium}
			divide_variable = { var = aluminium_export value = 400 }
			
			set_variable = { oil_export = resource_exported@oil}
			divide_variable = { var = oil_export value = 200 }
			
			set_variable = { steel_export = resource_exported@steel}
			divide_variable = { var = steel_export value = 400 }

			

			set_variable ={allexpenses = 0 }
			set_variable ={resourceexpenses = 0 }
			set_variable ={resourceincome = 0 }

			add_to_variable = { var = resourceincome value = rubber_export}
			add_to_variable = { var = resourceincome value = chromium_export}
			add_to_variable = { var = resourceincome value = tungsten_export}
			add_to_variable = { var = resourceincome value = steel_export}
			add_to_variable = { var = resourceincome value = oil_export}
			add_to_variable = { var = resourceincome value = aluminium_export}

			add_to_variable = { var = resourceexpenses value = rubber_import}
			add_to_variable = { var = resourceexpenses value = chromium_import}
			add_to_variable = { var = resourceexpenses value = tungsten_import}
			add_to_variable = { var = resourceexpenses value = steel_import}
			add_to_variable = { var = resourceexpenses value = oil_import}
			add_to_variable = { var = resourceexpenses value = aluminium_import} 
			
			#add_to_variable = { var = allexpenses value = debtexp}	
			
			add_to_variable = { var = allexpenses value = no}	
			add_to_variable = { var = allexpenses value = nerfeco}
			add_to_variable = { var = allexpenses value = tax_to_overlord}
			add_to_variable = { var = allexpenses value = depression}
			add_to_variable = { var = allexpenses value = nc}
			add_to_variable = { var = allexpenses value = rubber_import}
			add_to_variable = { var = allexpenses value = chromium_import}
			add_to_variable = { var = allexpenses value = tungsten_import}
			add_to_variable = { var = allexpenses value = steel_import}
			add_to_variable = { var = allexpenses value = oil_import}
			add_to_variable = { var = allexpenses value = aluminium_import}
			
			add_to_variable = { var = allexpenses value = ms}
			add_to_variable = { var = allexpenses value = nf}
			add_to_variable = { var = allexpenses value = navf}
			
			add_to_variable = { var = nmn value = tax }
			add_to_variable = { var = nmn value = resourceincome }
			#add_to_variable = { var = nmn value = cfff }
			
			subtract_from_variable = { var = nmn value = allexpenses }
			
			set_variable ={overcome = nmn}
            add_to_variable = { var = dx value = nmn  }
            
            if={
                limit={
                OR={
                    check_variable={nmn>1}
                    check_variable={nmn<-1}
            	    }
                }
                round_variable = dx
            }
            
            ###########################################
            
            if = {
                limit = { 
                    has_idea = undisturbed_isolation 
                }
                multiply_variable = {var = tax value = 25}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            if = {
                limit = { 
                    has_idea = isolation 
                }
                multiply_variable = {var = tax value = 25}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            if = {
                limit = { 
                    has_idea = civilian_economy 
                }
                multiply_variable = {var = tax value = 20}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            if = {
                limit = { 
                    has_idea = low_economic_mobilisation 
                }
                multiply_variable = {var = tax value = 20}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            if = {
                limit = { 
                    has_idea = partial_economic_mobilisation 
                }
                multiply_variable = {var = tax value = 15}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            if = {
                limit = { 
                    has_idea = war_economy
                }
                multiply_variable = {var = tax value = 15}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            if = {
                limit = { 
                    has_idea = tot_economic_mobilisation
                }
                multiply_variable = {var = tax value = 10}
                add_to_variable = { var = nmn value = tax }
                add_to_variable = { var = dx value = tax }
            }
            
            #################################################################################################################

            ################these are the conditions for the ideas to automatically apply to your country####################	
			
			every_country={
                limit={
            	    check_variable = { dx > 0 }
            	}
            	add_ideas = normal_money
			}
			
			every_country={
            	limit={
            	    check_variable = { dx < 0 }
            	}
            	remove_ideas = normal_money
			}
				
		    every_country={
            	limit={
            	    check_variable = { dx < 0 }
            	}
            	add_ideas = low_money
			}
			
			every_country={
            	limit={
				    Or={
            	        check_variable = { dx < -1000}
				        check_variable = { dx > 0}
            	    }
				}
            	remove_ideas = low_money
			}

			every_country={
            	limit={
            	    check_variable = { dx < -1000 }
            	}
            	add_ideas = bad_money
			}
			
			every_country={
            	limit={
				    Or={
            	        check_variable = { dx < -5000 }
				        check_variable = { dx > -1000 }
            	    }
				}
            	remove_ideas = bad_money
			}
				
  
			every_country={
            	limit={
            	    check_variable = { dx < -5000 }
            	}
            	add_ideas = very_low_money
			}
				
		    every_country={
            	limit={
            	    check_variable = { dx > -5000 }
            	}
            	remove_ideas = very_low_money
			}
				
		    every_country={
            	limit={
            	    check_variable = { dx < -10000 }
            	    #NOT={has_country_flag=money5}
			    add_ideas = National_Bankruptcy
				}
            }          	
            
 
        }   
    }
}
